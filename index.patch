diff --git a/index.html b/index.html
index 25c7b5a..8c0d2e1 100644
--- a/index.html
+++ b/index.html
@@ -1,358 +1,596 @@
 <!DOCTYPE html>
 <html lang="ru">
-
 <head>
-    <meta charset="UTF-8">
-    <meta name="viewport" content="width=device-width, initial-scale=1.0">
-    <title>Семейное древо</title>
-
-    <script src="https://d3js.org/d3.v7.min.js"></script>
-    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
-
-    <style>
-        * {
-            margin: 0;
-            padding: 0;
-            box-sizing: border-box
-        }
-
-        html,
-        body {
-            width: 100%;
-            height: 100%;
-            overflow: hidden;
-            font-family: Segoe UI, Tahoma, Verdana, sans-serif;
-            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%)
-        }
-
-        .app-container {
-            width: 100%;
-            height: 100vh;
-            display: flex;
-            flex-direction: column
-        }
-
-        .app-header {
-            background: #2c3e50;
-            color: #fff;
-            padding: 12px 20px;
-            display: flex;
-            justify-content: space-between;
-            align-items: center
-        }
-
-        .logo {
-            display: flex;
-            align-items: center;
-            gap: 12px
-        }
-
-        .logo i {
-            font-size: 26px;
-            color: #3498db
-        }
-
-        .logo h1 {
-            font-size: 20px
-        }
-
-        .controls {
-            display: flex;
-            gap: 12px;
-            align-items: center
-        }
-
-        .ctrl-btn {
-            width: 40px;
-            height: 40px;
-            border-radius: 50%;
-            background: rgba(255, 255, 255, .15);
-            border: none;
-            color: #fff;
-            cursor: pointer
-        }
-
-        .ctrl-btn:hover {
-            background: #3498db
-        }
-
-        .main-content {
-            flex: 1;
-            position: relative
-        }
-
-        #tree {
-            width: 100%;
-            height: 100%
-        }
-
-        .link {
-            fill: none;
-            stroke: rgba(44, 62, 80, .28);
-            stroke-width: 2
-        }
-
-        .node {
-            cursor: pointer
-        }
-
-        .card-shadow {
-            filter: drop-shadow(2px 2px 6px rgba(0, 0, 0, .15))
-        }
-
-        .info-panel {
-            position: fixed;
-            top: 80px;
-            right: 0;
-            width: 360px;
-            height: calc(100vh - 140px);
-            background: #fff;
-            border-radius: 14px 0 0 14px;
-            transform: translateX(calc(100% - 46px));
-            transition: .25s;
-            z-index: 100
-        }
-
-        .info-panel.open {
-            transform: translateX(0)
-        }
-
-        .info-tab {
-            position: absolute;
-            left: -46px;
-            top: 120px;
-            width: 46px;
-            height: 140px;
-            background: #2c3e50;
-            color: #fff;
-            display: flex;
-            align-items: center;
-            justify-content: center;
-            cursor: pointer
-        }
-
-        .info-header {
-            background: #2c3e50;
-            color: #fff;
-            padding: 14px
-        }
-
-        .info-content {
-            padding: 16px;
-            overflow: auto;
-            height: calc(100% - 52px)
-        }
-
-        .person-outer {
-            fill: #fff;
-            stroke-width: 2
-        }
-
-        .person-outer.m {
-            stroke: #3498db
-        }
-
-        .person-outer.f {
-            stroke: #e74c3c
-        }
-
-        .person-outer.u {
-            stroke: #95a5a6
-        }
-
-        @media(max-width:768px) {
-            .info-panel {
-                width: 90vw
-            }
-        }
-    </style>
+  <meta charset="UTF-8" />
+  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
+  <title>Семейное древо</title>
+
+  <script src="https://d3js.org/d3.v7.min.js"></script>
+  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
+
+  <style>
+    *{margin:0;padding:0;box-sizing:border-box}
+    html,body{width:100%;height:100%;overflow:hidden;font-family:Segoe UI,Tahoma,Verdana,sans-serif;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%)}
+    .app-container{width:100%;height:100vh;display:flex;flex-direction:column}
+    .app-header{background:#2c3e50;color:#fff;padding:12px 20px;display:flex;justify-content:space-between;align-items:center;box-shadow:0 4px 12px rgba(0,0,0,.15);z-index:10}
+    .logo{display:flex;align-items:center;gap:12px}
+    .logo i{font-size:26px;color:#3498db}
+    .logo h1{font-size:20px}
+    .controls{display:flex;gap:10px;align-items:center}
+    .ctrl-btn{width:40px;height:40px;border-radius:50%;background:rgba(255,255,255,.15);border:none;color:#fff;cursor:pointer}
+    .ctrl-btn:hover{background:#3498db}
+    .main-content{flex:1;position:relative}
+    #tree{width:100%;height:100%}
+    .link{fill:none;stroke:rgba(44,62,80,.28);stroke-width:2;stroke-linecap:round}
+    .node{cursor:pointer}
+    .card-shadow{filter:drop-shadow(2px 2px 6px rgba(0,0,0,.15))}
+    .person-outer{fill:#fff;stroke-width:2}
+    .person-outer.m{stroke:#3498db}
+    .person-outer.f{stroke:#e74c3c}
+    .person-outer.u{stroke:#95a5a6}
+    .node.selected .person-outer{stroke:#f39c12!important;stroke-width:4!important}
+
+    .info-panel{position:fixed;top:80px;right:0;width:360px;height:calc(100vh - 140px);background:#fff;border-radius:14px 0 0 14px;transform:translateX(calc(100% - 46px));transition:.25s;z-index:100;box-shadow:0 12px 34px rgba(0,0,0,.25);overflow:hidden}
+    .info-panel.open{transform:translateX(0)}
+    .info-tab{position:absolute;left:-46px;top:120px;width:46px;height:140px;background:#2c3e50;color:#fff;display:flex;align-items:center;justify-content:center;cursor:pointer}
+    .info-header{background:#2c3e50;color:#fff;padding:14px;display:flex;align-items:center;justify-content:space-between}
+    .close-btn{background:none;border:none;color:#fff;font-size:24px;cursor:pointer;line-height:1}
+    .info-content{padding:16px;overflow:auto;height:calc(100% - 52px)}
+    @media(max-width:768px){.info-panel{width:90vw;top:auto;bottom:20px;height:min(70vh,520px)}}
+  </style>
 </head>
 
 <body>
-    <div class="app-container">
-
-        <header class="app-header">
-            <div class="logo">
-                <i class="fas fa-tree"></i>
-                <h1>Семейное древо</h1>
-            </div>
-            <div class="controls">
-                <button id="zoom-in" class="ctrl-btn"><i class="fas fa-search-plus"></i></button>
-                <button id="zoom-out" class="ctrl-btn"><i class="fas fa-search-minus"></i></button>
-                <button id="reset-view" class="ctrl-btn"><i class="fas fa-expand"></i></button>
-            </div>
-        </header>
-
-        <div class="main-content">
-            <div id="tree"></div>
-        </div>
-
-        <div id="info-panel" class="info-panel">
-            <div class="info-tab" id="info-tab"><i class="fas fa-user"></i></div>
-            <div class="info-header">Информация</div>
-            <div id="person-info" class="info-content">Выберите человека</div>
-        </div>
-
-    </div>
-
-    <script>
+  <div class="app-container">
+    <header class="app-header">
+      <div class="logo">
+        <i class="fas fa-tree"></i>
+        <h1>Семейное древо</h1>
+      </div>
+      <div class="controls">
+        <button id="zoom-in" class="ctrl-btn" title="Увеличить"><i class="fas fa-search-plus"></i></button>
+        <button id="zoom-out" class="ctrl-btn" title="Уменьшить"><i class="fas fa-search-minus"></i></button>
+        <button id="reset-view" class="ctrl-btn" title="Сброс"><i class="fas fa-expand"></i></button>
+      </div>
+    </header>
+
+    <div class="main-content">
+      <div id="tree"></div>
+    </div>
+
+    <div id="info-panel" class="info-panel">
+      <div class="info-tab" id="info-tab" title="Информация"><i class="fas fa-user"></i></div>
+      <div class="info-header">
+        <div>Информация</div>
+        <button class="close-btn" id="close-info" title="Свернуть">&times;</button>
+      </div>
+      <div id="person-info" class="info-content">Выберите человека</div>
+    </div>
+  </div>
+
+  <script>
         /* =====================
            STATE
         ===================== */
         let data = null, zoom = null;
         let rootId = null, currentId = null;
         let branchMode = false, branchFocus = null;
@@ -11,16 +249,20 @@
            INIT
         ===================== */
-        fetch('./3.ged').then(r => r.text()).then(t => {
-            data = parseGedcom(t);
-            rootId = findRoot(data);
-            renderFull();
-            setupUI();
-        });
+        fetch('./3.ged')
+          .then(r => r.text())
+          .then(t => {
+            data = parseGedcom(t);
+            rootId = findRoot(data);
+            renderFull();
+            setupUI();
+          })
+          .catch(err => console.error('GED load error', err));
@@ -67,6 +309,7 @@
                 if (cur.t === 'F') {
                     const f = fams[cur.id];
                     if (tag === 'HUSB') f.husb = val.replace(/@/g, '');
                     if (tag === 'WIFE') f.wife = val.replace(/@/g, '');
                     if (tag === 'CHIL') f.chil.push(val.replace(/@/g, ''));
-                    if (lvl === 2 && evt) f[evt] = val;
+                    if (lvl === 2 && evt && tag === 'DATE') f[evt] = val;
                 }
             });
             return { people, fams };
         }
@@ -79,6 +322,60 @@
 
         /* =====================
            TREE MODEL
         ===================== */
         function buildDesc(pId, seen = new Set()) {
@@ -95,16 +392,64 @@
                 const f = data.fams[fid];
                 const spouse = (f.husb === pId) ? f.wife : f.husb;
-                const u = { type: 'union', spouse, marriage: f.marriage, children: [] };
+                const u = { type: 'union', fid, spouse, marriage: f.marriage || '', children: [] };
                 f.chil.forEach(c => {
                     const ch = buildDesc(c, new Set(seen));
                     if (ch) u.children.push(ch);
                 });
-                if (u.children.length) node.children.push(u);
+                if (u.spouse || u.children.length) node.children.push(u);
             });
             if (!node.children.length) delete node.children;
             return node;
         }
+
+        function buildAncestorsChain(pId) {
+          const p = data.people[pId];
+          const famc = p?.FAMC?.[0];
+          if (!famc) return null;
+          const f = data.fams[famc];
+          if (!f) return null;
+
+          const node = { type: 'anc_union', fid: famc, father: f.husb, mother: f.wife, marriage: f.marriage || '', children: [] };
+          const fa = f.husb ? buildAncestorsChain(f.husb) : null;
+          const mo = f.wife ? buildAncestorsChain(f.wife) : null;
+          if (fa) node.children.push(fa);
+          if (mo) node.children.push(mo);
+          if (!node.children.length) delete node.children;
+          return node;
+        }
@@ -123,6 +468,35 @@
             });
         }
 
         /* =====================
            RENDER
         ===================== */
         function renderFull() {
-            const tree = buildDesc(rootId);
-            drawTree(tree);
+            branchMode = false;
+            branchFocus = null;
+            const tree = buildDesc(rootId);
+            drawTree(tree);
         }
+
+        function renderBranch(focusId) {
+          branchMode = true;
+          branchFocus = focusId;
+
+          const center = makePerson(focusId);
+          const desc = buildDesc(focusId);
+          const ancUnion = buildAncestorsChain(focusId);
+
+          const ancRoot = structuredClone(center);
+          if (ancUnion) ancRoot.children = [ancUnion];
+
+          drawBranch(center, desc, ancRoot);
+        }
+
+        function makePerson(id){
+          const p = data.people[id];
+          return { type:'person', id, name:p?.name||'', sex:p?.sex||'', b:p?.birth||'', d:p?.death||'' };
+        }
@@ -132,37 +506,94 @@
             d3.select('#tree').selectAll('*').remove();
             const w = window.innerWidth, h = window.innerHeight;
             const svg = d3.select('#tree').append('svg').attr('width', w).attr('height', h);
             const g = svg.append('g');
             zoom = d3.zoom().scaleExtent([.1, 3]).on('zoom', e => g.attr('transform', e.transform));
             svg.call(zoom);
 
             const layout = d3.tree().nodeSize([140, 380]);
             const root = d3.hierarchy(tree);
             layout(root);
             inlineUnions(root, 1);
 
-            const link = d3.linkHorizontal().x(d => ry(d)).y(d => rx(d));
+            const link = d3.linkHorizontal().x(p => p.y).y(p => p.x);
 
             g.selectAll('.link')
                 .data(root.links())
                 .enter().append('path')
                 .attr('class', 'link')
                 .attr('d', d => link({
                     source: { x: rx(d.source), y: ry(d.source) },
                     target: { x: rx(d.target), y: ry(d.target) }
                 }));
 
             const node = g.selectAll('.node')
                 .data(root.descendants())
                 .enter().append('g')
                 .attr('class', 'node')
                 .attr('transform', d => `translate(${ry(d)},${rx(d)})`)
                 .each(function (d) { drawNode(d3.select(this), d.data) });
 
             fit(svg, g, w, h);
         }
+
+        function drawBranch(centerPerson, descTree, ancTree){
+          d3.select('#tree').selectAll('*').remove();
+          const w = window.innerWidth, h = window.innerHeight;
+          const svg = d3.select('#tree').append('svg').attr('width', w).attr('height', h);
+          const g = svg.append('g');
+          zoom = d3.zoom().scaleExtent([.1, 3]).on('zoom', e => g.attr('transform', e.transform));
+          svg.call(zoom);
+
+          const layout = d3.tree().nodeSize([140, 380]).separation((a,b)=>a.parent===b.parent?1.1:1.35);
+
+          const descRoot = d3.hierarchy(descTree);
+          layout(descRoot);
+          inlineUnions(descRoot, 1);
+
+          const ancRoot = d3.hierarchy(ancTree);
+          layout(ancRoot);
+          ancRoot.descendants().forEach(d => { d.y = -d.y; d._y = -(d._y ?? d.y); });
+          inlineUnions(ancRoot, -1);
+
+          const cx = w/2, cy = h/2;
+          const link = d3.linkHorizontal().x(p => cx + p.y).y(p => cy + p.x);
+
+          const links = [
+            ...descRoot.links().filter(l => !(l.target.data.type==='person' && l.target.data.id===centerPerson.id)),
+            ...ancRoot.links().filter(l => !(l.target.data.type==='person' && l.target.data.id===centerPerson.id)),
+          ];
+
+          g.selectAll('.link')
+            .data(links)
+            .enter().append('path')
+            .attr('class','link')
+            .attr('d', d => link({
+              source:{ x: rx(d.source), y: ry(d.source) },
+              target:{ x: rx(d.target), y: ry(d.target) }
+            }));
+
+          const nodes = [
+            ...descRoot.descendants().filter(d => !(d.data.type==='person' && d.data.id===centerPerson.id)),
+            ...ancRoot.descendants().filter(d => !(d.data.type==='person' && d.data.id===centerPerson.id)),
+          ];
+
+          g.selectAll('.node')
+            .data(nodes)
+            .enter().append('g')
+            .attr('class', d => 'node ' + d.data.type)
+            .attr('transform', d => `translate(${cx + ry(d)},${cy + rx(d)})`)
+            .each(function(d){ drawNode(d3.select(this), d.data); });
+
+          const cg = g.append('g').attr('class','node person selected').attr('transform', `translate(${cx},${cy})`);
+          drawNode(cg, centerPerson);
+
+          fit(svg, g, w, h);
+        }
@@ -170,13 +601,29 @@
         function drawNode(g, d) {
             if (d.type === 'person') {
                 const cls = d.sex === 'M' ? 'm' : d.sex === 'F' ? 'f' : 'u';
                 g.append('rect').attr('x', -110).attr('y', -40).attr('width', 220).attr('height', 80)
                     .attr('rx', 14).attr('class', 'person-outer ' + cls);
                 g.append('text').attr('text-anchor', 'middle').attr('y', -8)
                     .text(d.name).style('font-weight', '700');
                 if (d.b || d.d)
                     g.append('text').attr('text-anchor', 'middle').attr('y', 14)
                         .style('font-size', '11px').text(`${d.b || ''}${d.d ? ' – ' + d.d : ''}`);
-                g.on('click', () => selectPerson(d.id));
+                g.on('click', (ev) => {
+                  ev.stopPropagation();
+                  if (!branchMode) renderBranch(d.id);
+                  else if (branchFocus === d.id) renderFull();
+                  else renderBranch(d.id);
+                  selectPerson(d.id);
+                });
             }
             if (d.type === 'union') {
                 g.append('circle').attr('r', 6).attr('fill', '#bbb');
                 if (d.marriage)
                     g.append('text').attr('y', 18).attr('text-anchor', 'middle')
                         .style('font-size', '10px').text(d.marriage);
                 if (d.spouse) {
                     const sp = data.people[d.spouse];
                     const x = 200;
-                    g.append('line').attr('x1', 10).attr('x2', x - 90).attr('stroke', '#999');
+                    g.append('path').attr('d', `M 10 0 C 45 0, 90 0, ${x-90} 0`).attr('fill','none').attr('stroke','#999').attr('stroke-width',2);
                     const sg = g.append('g').attr('transform', `translate(${x},0)`)
-                        .on('click', () => selectPerson(d.spouse));
+                        .on('click', (ev) => { ev.stopPropagation(); selectPerson(d.spouse); renderBranch(d.spouse); });
                     sg.append('rect').attr('x', -90).attr('y', -28).attr('width', 180).attr('height', 56)
                         .attr('rx', 12).attr('class', 'person-outer ' + (sp.sex === 'M' ? 'm' : sp.sex === 'F' ? 'f' : 'u'));
                     sg.append('text').attr('text-anchor', 'middle').attr('y', 5).text(sp.name);
                 }
             }
+            if (d.type === 'anc_union') {
+              g.append('circle').attr('r', 6).attr('fill', '#bbb');
+              if (d.father && data.people[d.father]) drawSideParent(g, data.people[d.father], d.father, -200, -50);
+              if (d.mother && data.people[d.mother]) drawSideParent(g, data.people[d.mother], d.mother, -200, 50);
+            }
         }
+
+        function drawSideParent(g, person, id, x, y){
+          g.append('path').attr('d', `M -10 0 C -45 0, -90 ${y}, ${x+90} ${y}`).attr('fill','none').attr('stroke','#999').attr('stroke-width',2);
+          const sg = g.append('g').attr('transform', `translate(${x},${y})`).on('click', (ev)=>{ ev.stopPropagation(); selectPerson(id); renderBranch(id); });
+          const cls = person.sex === 'M' ? 'm' : person.sex === 'F' ? 'f' : 'u';
+          sg.append('rect').attr('x', -90).attr('y', -28).attr('width', 180).attr('height', 56).attr('rx', 12).attr('class', 'person-outer ' + cls);
+          sg.append('text').attr('text-anchor','middle').attr('y', 5).text(person.name || '');
+        }
@@ -213,14 +660,25 @@
         function setupUI() {
             document.getElementById('zoom-in').onclick = () => d3.select('svg').transition().call(zoom.scaleBy, 1.2);
             document.getElementById('zoom-out').onclick = () => d3.select('svg').transition().call(zoom.scaleBy, .8);
-            document.getElementById('reset-view').onclick = () => renderFull();
+            document.getElementById('reset-view').onclick = () => branchMode && branchFocus ? renderBranch(branchFocus) : renderFull();
             document.getElementById('info-tab').onclick = () =>
                 document.getElementById('info-panel').classList.toggle('open');
+            document.getElementById('close-info').onclick = () =>
+                document.getElementById('info-panel').classList.remove('open');
+            window.addEventListener('resize', () => branchMode && branchFocus ? renderBranch(branchFocus) : renderFull());
         }
     </script>
 </body>
 
 </html>
